create database ott;
drop table if exists netflix;
create table netflix(
SHOW_ID VARCHAR(10),
 TYPE VARCHAR(10),
 TITLE VARCHAR(250),
 DIRECTOR VARCHAR(550),
 CASTS VARCHAR(1050),
 COUNTRY VARCHAR(550),
 DATE_ADDED VARCHAR(55),
 RELEASE_YEAR INT,
 RATING  VARCHAR(15),
 DURATION  VARCHAR (15),
 LISTED_IN VARCHAR(250),
 DESCRIPTION  VARCHAR(550)
 );
 select*from netflix;
 -- Q1 COUNT THE NUMBER OF MOVIES VS TV SHOWS --
 SELECT
 TYPE,
 COUNT(*)
 FROM NETFLIX
GROUP BY 1
 -- Q2 FIND MOST COMMON RATING FOR MOVIES AND TV SHOWS --
WITH RatingCounts as (
SELECT
TYPE,
RATING,
COUNT (*)AS RATING_COUNT
FROM NETFLIX
GROUP BY TYPE,RATING
),
RankedRatings AS (
SELECT
TYPE,
RATING,
RATING_COUNT,
RANK()OVER (PARTITION BY TYPE ORDER BY RATING_COUNT DESC)AS rank
FROM RatingCounts
)
select
type,
rating as most_frequent_rating
from RankedRatings
where rank=1;

--Q3 LIST  ALL MOVIES RELEASED IN SPECIFIC YEAR
SELECT*
FROM NETFLIX
WHERE RELEASE_YEAR =2020

 -- Q4 FIND THE TOP  5 COUNTRIES WITH THE MOST CONTENT ON NETFLIX
 SELECT* FROM
 (
 SELECT 
 UNNEST(STRING_TO_ARRAY(COUNTRY,','))AS COUNTRY,
COUNT(*)AS TOTAL_CONTENT
FROM NETFLIX
GROUP BY 1
)AS T1
WHERE COUNTRY IS NOT NULL
ORDER BY TOTAL_CONTENT DESC
LIMIT 5;

--Q5 IDENTIFY THE LONGEST MOVIE--
SELECT * FROM NETFLIX
WHERE TYPE ='MOVIE'
AND
DURATION=(SELECT MAX (DURATION) FROM NETFLIX)

















 
 
 )














